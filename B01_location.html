<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Location - James Cook University</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        .location-content {
            padding: 1.5rem;
        }

        .header-alignment {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 0 20px;
            margin-bottom: 30px;
        }

        .location-question {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #222;
            line-height: 1.3;
            text-align: left;
        }
        .campus-selection {
            margin-bottom: 2rem;
            padding: 0 20px;
            margin-top: -2rem;
        }

        .campus-selection h3 {
            font-size: 1.2rem;
            color: #222;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .campus-options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .campus-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #ddd;
            background-color: white;
            color: #333;
        }

        .campus-btn.active {
            background-color: #005ea7;
            color: white;
            border-color: #005ea7;
        }

        .campus-btn:hover:not(.active) {
            border-color: #005ea7;
            color: #005ea7;
        }

        .map-outer-container {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            margin-top: -1rem;
        }

        .map-container {
            cursor: grab;
            overflow: hidden;
        }

        .map-image {
            width: 50%;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        .map-controls {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .map-control-btn {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1rem;
        }

        .map-control-btn:hover {
            background-color: #f0f0f0;
            transform: scale(1.05);
        }

        .location-info {
            text-align: center;
        }

        .location-name {
            font-size: 1.5rem;
            font-weight: 600;
            color: #222;
        }

        .location-address {
            color: #666;
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        .location-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1rem;
        }

        .primary-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            width: 180px;
            margin: 0 auto;
        }

        .primary-btn {
            background-color: #005ea7;
            color: white;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
        }
    </style>
    <script src="auth.js"></script>
</head>
<body>
    <div class="container">
        <main class="location-content">
            <div class="header-alignment">
                <h2 class="location-question">where are you located? </h2>
                <button class="back-btn" onclick="window.location.href='B02_home.html'">
                    <i class="fas fa-arrow-left mr-2"></i>Back
                </button>
            </div>

            <div class="campus-selection">
                <div class="campus-options">
                    <button class="campus-btn active" data-campus="singapore">Singapore</button>
                    <button class="campus-btn" data-campus="townsville">Townsville</button>
                    <button class="campus-btn" data-campus="cairns">Cairns</button>
                </div>
            </div>

            <div class="map-outer-container">
                <div class="map-container">
                    <img src="Images/location_singapore.png" alt="Map showing location of James Cook University Singapore" class="map-image active" data-campus="singapore">
                    <img src="Images/location_townsville.png" alt="Map showing location of James Cook University Townsville" class="map-image" data-campus="townsville" style="display: none;">
                    <img src="Images/location_cairns.png" alt="Map showing location of James Cook University Cairns" class="map-image" data-campus="cairns" style="display: none;">

                    <div class="map-controls">
                        <button class="map-control-btn zoom-in">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="map-control-btn zoom-out">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="location-info">
                <h3 class="location-name" data-campus="singapore">James Cook University, Singapore</h3>
                <h3 class="location-name" data-campus="townsville" style="display: none;">James Cook University, Townsville</h3>
                <h3 class="location-name" data-campus="cairns" style="display: none;">James Cook University, Cairns</h3>
                
                <p class="location-address" data-campus="singapore">149 Sims Drive, Singapore 387380</p>
                <p class="location-address" data-campus="townsville" style="display: none;">1 James Cook Drive, Douglas, QLD 4814, Australia</p>
                <p class="location-address" data-campus="cairns" style="display: none;">1 Trinity Beach Road, Trinity Park, QLD 4879, Australia</p>
            </div>

            <div class="location-actions">
                <button class="primary-btn confirm-btn" onclick="window.location.href='B06_room_selection.html'">confirm</button>
            </div>
        </main>
    </div>
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-logo">
                <span>SmartSeat</span>
            </div>
            <div class="footer-links">
                <a href="#">Help</a>
                <a href="#">FAQs</a>
                <a href="#">Contact</a>
                <a href="#">Privacy</a>
            </div>
            <div class="footer-copyright">
                © 2025 SmartSeat. MJGA TEAM making classroom seating smarter.
            </div>
        </div>
    </footer>
    
    <script>
        const campusBtns = document.querySelectorAll('.campus-btn');
        const mapImages = document.querySelectorAll('.map-image');
        const locationNames = document.querySelectorAll('.location-name');
        const locationAddresses = document.querySelectorAll('.location-address');
        const largerMapLinks = document.querySelectorAll('.view-larger-map');

        const campusMapLinks = {
            singapore: "https://maps.google.com/maps?q=James+Cook+University+Singapore",
            townsville: "https://maps.google.com/maps?q=James+Cook+University+Townsville",
            cairns: "https://maps.google.com/maps?q=James+Cook+University+Cairns"
        };

        let currentCampus = 'singapore';
        campusBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const campus = btn.getAttribute('data-campus');
                currentCampus = campus;
                localStorage.setItem('selectedCampus', campus);

                campusBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                mapImages.forEach(img => {
                    img.style.display = img.getAttribute('data-campus') === campus ? 'block' : 'none';
                });
                
                locationNames.forEach(name => {
                    name.style.display = name.getAttribute('data-campus') === campus ? 'block' : 'none';
                });
                
                locationAddresses.forEach(addr => {
                    addr.style.display = addr.getAttribute('data-campus') === campus ? 'block' : 'none';
                });
                
                document.querySelector('.view-larger-map').href = campusMapLinks[campus];
            });
        });

        const mapContainer = document.querySelector('.map-container');
        const mapImage = document.querySelector('.map-image.active');
        const zoomInBtn = document.querySelector('.zoom-in');
        const zoomOutBtn = document.querySelector('.zoom-out');

        let scale = 1;
        const scaleStep = 0.2;
        const maxScale = 2;
        const minScale = 0.8;

        zoomInBtn.addEventListener('click', () => {
            if (scale < maxScale) {
                scale += scaleStep;
                updateMapScale();
            }
        });

        zoomOutBtn.addEventListener('click', () => {
            if (scale > minScale) {
                scale -= scaleStep;
                updateMapScale();
            }
        });

        function updateMapScale() {
            const activeMap = document.querySelector('.map-image[style*="display: block"]') || 
                                document.querySelector('.map-image.active');
            if (activeMap) {
                activeMap.style.transform = `scale(${scale})`;
                activeMap.style.transformOrigin = 'center';
            }
        }

        let isDragging = false;
        let startX, startY;
        let translateX = 0, translateY = 0;
        let lastTranslateX = 0, lastTranslateY = 0;

        mapContainer.addEventListener('mousedown', startDrag);
        mapContainer.addEventListener('touchstart', startDrag, { passive: true });

        document.addEventListener('mousemove', drag);
        document.addEventListener('touchmove', drag, { passive: true });

        document.addEventListener('mouseup', endDrag);
        document.addEventListener('touchend', endDrag);

        function startDrag(e) {
            isDragging = true;
            
            if (e.type === 'mousedown') {
                startX = e.clientX - lastTranslateX;
                startY = e.clientY - lastTranslateY;
            } else {
                startX = e.touches[0].clientX - lastTranslateX;
                startY = e.touches[0].clientY - lastTranslateY;
            }
            
            mapContainer.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            
            let clientX, clientY;
            if (e.type === 'mousemove') {
                clientX = e.clientX;
                clientY = e.clientY;
            } else {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            }
            
            translateX = clientX - startX;
            translateY = clientY - startY;
            
            updateMapPosition();
        }

        function endDrag() {
            isDragging = false;
            lastTranslateX = translateX;
            lastTranslateY = translateY;
            mapContainer.style.cursor = 'grab';
        }

        function updateMapPosition() {
            const activeMap = document.querySelector('.map-image[style*="display: block"]') || 
                                document.querySelector('.map-image.active');
            if (activeMap) {
                activeMap.style.transform = `scale(${scale}) translate(${translateX/scale}px, ${translateY/scale}px)`;
            }
        }

        // 确认按钮：确保已选择 campus
        document.querySelector('.confirm-btn').addEventListener('click', (e)=>{
            e.preventDefault();
            if(!currentCampus){ alert('Please select a campus first'); return; }
            localStorage.setItem('selectedCampus', currentCampus);
            window.location.href='B06_room_selection.html';
        });
    </script>
</body>
</html>